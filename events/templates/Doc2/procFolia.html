{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href={% static "css/table.css" %}>
</head>
<body>
    {% include 'navbar.html' %}
    <br>
    <label for="filter-column">Filtracja po Wytłaczarkach:</label>
    <select id="filter-column">
      <option value="">Wszystko</option>
      <option value="w1">W1</option>
      <option value="w2">W2</option>
      <option value="w3">W3</option>
      <!-- Add more options for other columns -->
    </select>
    <br>
    {% include 'Doc2/ProcFoliaTable1.html' %}


{#   # {% for post in production_data %}#}
        {% include 'Doc2/ProcFoliaTable2.html' %}
    <br>
    <div style="display: flex; flex-direction: column; align-items: center;">
  <button class="p-3 d-block float-right" id="btn-below" disabled>Dodaj Rolkę</button>
  <div style="margin-top: 20px;">
     {% include 'Doc2/ProcFoliaTable3.html' %}
  </div>
</div>


{#    {% endfor %}#}
{#    {% for post in number_data %}#}



{#     {% endfor %}#}
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<script>
        var selectedCell = null;

    $(document).ready(function(){

        $("td[data-id]").click(function(){
            // Remove previous selection if any
            if (selectedCell !== null) {
                selectedCell.removeClass("selected-cell");
            }
            $("td[data-id]").removeClass("selected-cell");

            console.log("HIHI")
            // Get ID of clicked cell
            var id = $(this).data("id");
            // Set current cell as selected
            console.log(selectedCell)
            selectedCell = $(this);
            console.log(selectedCell)
            selectedCell.addClass("selected-cell");

            // Activate button below the table
            $("#btn-below").prop("disabled", false).data("id", id);
        });

        $("#btn-below").click(function(){
            // Get ID of clicked button
            var id = $(this).data("id");

            // Redirect to Django page with ID parameter
            window.location.href = "/formFolia/" + id;
        });
    });
</script>

<style>
    .selected-cell {
        background-color: #d33333; /* Change the background color as desired */
    }
</style>
   <script>
  $(document).ready(function() {
    $('td[data-id]').click(function() {
      var id = $(this).data("id");
      console.log(id)
      $.ajax({
        url: 'get-data/' + id,
        success: function(data) {
          var tbody = $('#tbodyid');
          $("#tbodyid").empty();
          var counter = 1;
          $.each(data, function(index, row) {
              $.each(row, function(index2, row2) {
            var tr = $('<tr>');
            $('<td>').html(counter).appendTo(tr);
            $('<td>').html(row2.id).appendTo(tr);
            $('<td>').html(row2.data).appendTo(tr);
            $('<td>').html(row2.zmiana).appendTo(tr);
            $('<td>').html(row2.rolka).appendTo(tr);
            $('<td>').html(row2.nrwytl).appendTo(tr);
            $('<td>').html(row2.dlugrolkiprod).appendTo(tr);
            $('<td>').html(row2.wagarolkiprod).appendTo(tr);
            $('<td>').html(row2.walce).appendTo(tr);
            $('<td>').html(row2.slimak).appendTo(tr);
            $('<td>').html(row2.uwagi).appendTo(tr);
            $('<td>').html(row2.wynikowa).appendTo(tr);
            $('<td>').html(row2.wynik).appendTo(tr);
            $('<td>').html(row2.operator).appendTo(tr);
            $('<td>').html(row2.mieszanka).appendTo(tr);
            var date = row2.id.split('/')[0];  // extract the date component from the row2.id string
            var pk = row2.id.split('/')[1];  // extract the pk component from the row2.id string
            var rolka = row2.rolka;
            var editUrl = `/editRolForm/${date}/${pk}/${rolka}`;
            var editButton = $('<a>').attr('href', editUrl).text('Edytuj');
            $('<td>').append(editButton).appendTo(tr);
            tbody.append(tr);
            counter++;
            });
          });
            $('td:nth-child(13)').each(function() {
            var value = $(this).text();
            if (parseFloat(value.replace(',', '.')) > 100) {
              $(this).css('color', 'red');
            }
          });
        }
      });
    });
  });

  </script>
   <script>
  $(document).ready(function() {
  // Set up the clickbox to filter the table
  $('#filter-column').on('change', function() {
    var selectedColumn = $(this).val();
    var tableRows = $('#mainTable tbody #special');
      tableRows.hide()
    // If "All" is selected, show all rows
    if (selectedColumn === '') {
      tableRows.show();
      return;
    }

    // Loop through the table rows and hide/show based on selected column value
    tableRows.each(function() {

      var rowValue = $(this).text().toLowerCase();
      if (rowValue.indexOf(selectedColumn) !== -1) {
        $(this).show();
      } else {
        $(this).hide();
      }
    });
  });
});


</script>
<script>
    $(document).ready(function(){
        // Function to check if a value is over 100
        function isOver100(value) {
            return parseFloat(value.replace(',', '.')) > 100;
        }

        // Iterate over each row in the table
        $("#data-table tbody tr").each(function(){
            // Get the value in the "GrubośćWynikdoZakl" cell
            var value = $(this).find("td:nth-child(13)").text();
            console.log(value)
            // Check if the value is over 100
            if (isOver100(value)) {
                // Apply the red color to the cell
                $(this).find("td:nth-child(13)").css("color", "red");
            }
        });
    });
</script>
<script>
     $(document).ready(function() {
    $('td[data-id]').click(function() {
      var id = $(this).data("id");
      $.ajax({
        url: 'get-dataCal/' + id,
        success: function(data) {
            $.each(data, function(index, row) {


                $('#wagaProd').html(row[0]);
                $('#wagaEnd').html(row[1]);
                $('#dlugProd').html(row[2]);
                $('#dlugEnd').html(row[3]);
                $('#rolkaProd').html(row[4]);
                $('#rolkaEnd').html(row[5]);
            });
        }
       });
    });
  });
</script>
</html>